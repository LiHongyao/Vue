# ä¸€ã€æ¦‚è¿°

å…ˆæ¥çœ‹ä¸¤ä¸ªæ¦‚å¿µï¼Œäº†è§£è¿‡æ¸¡ä¸åŠ¨ç”»ï¼š

> è¿‡æ¸¡ï¼ˆTransitionï¼‰ï¼š
>
> - è¿‡æ¸¡æ˜¯æŒ‡åœ¨å…ƒç´ çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä»ä¸€ä¸ªçŠ¶æ€è¿‡æ¸¡åˆ°å¦ä¸€ä¸ªçŠ¶æ€çš„è¿‡ç¨‹ã€‚
> - åœ¨ CSS ä¸­ï¼Œå¯ä»¥ä½¿ç”¨è¿‡æ¸¡æ•ˆæœæ¥å®šä¹‰å…ƒç´ åœ¨ä¸åŒçŠ¶æ€ä¹‹é—´çš„å¹³æ»‘è¿‡æ¸¡ã€‚
> - è¿‡æ¸¡å¯ä»¥æ§åˆ¶å…ƒç´ çš„å±æ€§ï¼ˆå¦‚ä½ç½®ã€å¤§å°ã€é¢œè‰²ç­‰ï¼‰åœ¨ä¸åŒçŠ¶æ€ä¹‹é—´çš„æ¸å˜å˜åŒ–ã€‚
> - è¿‡æ¸¡é€šå¸¸ç”±ä¸¤ä¸ªä¸»è¦çš„å±æ€§ç»„æˆï¼š`transition-property`ï¼ˆæŒ‡å®šè¦è¿‡æ¸¡çš„å±æ€§ï¼‰å’Œ `transition-duration`ï¼ˆæŒ‡å®šè¿‡æ¸¡çš„æŒç»­æ—¶é—´ï¼‰

> åŠ¨ç”»ï¼ˆAnimationï¼‰ï¼š
>
> - åŠ¨ç”»æ˜¯æŒ‡å…ƒç´ ä»ä¸€ä¸ªçŠ¶æ€åˆ°å¦ä¸€ä¸ªçŠ¶æ€çš„å¹³æ»‘å˜åŒ–ï¼Œå¸¦æœ‰ä¸€å®šçš„æ—¶é—´é—´éš”å’Œè¿ç»­çš„å¸§ã€‚
> - åœ¨ CSS ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å…³é”®å¸§åŠ¨ç”»ï¼ˆKeyframe Animationï¼‰æ¥å®šä¹‰å…ƒç´ çš„åŠ¨ç”»æ•ˆæœã€‚
> - åŠ¨ç”»å¯ä»¥é€šè¿‡æŒ‡å®šå…³é”®å¸§ï¼ˆå³åŠ¨ç”»çš„æ¯ä¸ªé˜¶æ®µï¼‰å’Œå…³é”®å¸§ä¹‹é—´çš„è¿‡æ¸¡æ–¹å¼æ¥æè¿°å…ƒç´ çš„è¿åŠ¨å’Œå˜åŒ–ã€‚
> - åŠ¨ç”»é€šå¸¸ç”±å¤šä¸ªå…³é”®å¸§å’Œä¸€äº›å±æ€§ç»„æˆï¼Œå¦‚ `animation-name`ï¼ˆæŒ‡å®šåŠ¨ç”»çš„åç§°ï¼‰ã€`animation-duration`ï¼ˆæŒ‡å®šåŠ¨ç”»çš„æŒç»­æ—¶é—´ï¼‰å’Œ `animation-timing-function`ï¼ˆæŒ‡å®šåŠ¨ç”»çš„è¿‡æ¸¡æ–¹å¼ï¼‰ç­‰

äºŒè€…éƒ½ä¼šè®©ä½ çš„é¡µé¢å…ƒç´ åŠ¨èµ·æ¥ï¼ŒåŒºåˆ«åœ¨äºï¼š

**è¿‡æ¸¡ï¼ˆTransitionï¼‰**

- éœ€è¦äº‹ä»¶è§¦å‘ï¼Œæ¯”å¦‚ `hover`ã€`click` ç­‰ï¼›
- ä¸€æ¬¡æ€§çš„ï¼›
- åªèƒ½å®šä¹‰å¼€å§‹å’Œç»“æŸçŠ¶æ€ï¼Œä¸èƒ½å®šä¹‰ä¸­é—´çŠ¶æ€ï¼›

**åŠ¨ç”»ï¼ˆAnimationï¼‰**

- ä¸éœ€è¦äº‹ä»¶è§¦å‘ï¼›
- æ˜¾ç¤ºåœ°éšç€æ—¶é—´çš„æµé€ï¼Œå‘¨æœŸæ€§çš„æ”¹å˜å…ƒç´ çš„ CSS å±æ€§å€¼ï¼ŒåŒºåˆ«äºä¸€æ¬¡æ€§ã€‚
- é€šè¿‡ç™¾åˆ†æ¯”æ¥å®šä¹‰è¿‡ç¨‹ä¸­çš„ä¸åŒå½¢æ€ï¼Œå¯ä»¥å¾ˆç»†è…»ã€‚

# äºŒã€å¿†å¾€æ˜”

æˆ‘ä»¬å…ˆæ¥ç®€å•å›é¡¾ä¸€ä¸‹åœ¨CSSä¸­å¦‚ä½•å®ç°è¿‡æ¸¡ä¸åŠ¨ç”»æ•ˆæœã€‚

## 1. Transition in CSS

```vue
<script setup lang="ts">
// -- imports
import { ref } from 'vue';

// -- refs
const transition = ref(false);
</script>

<template>
  <div class="box" :class="{ transition }"></div>
  <button type="button" @click="transition = !transition">Toggle</button>
</template>

<style scoped>
.box {
  width: 100px;
  height: 100px;
  margin-bottom: 16px;
  background-color: red;
  transition: 0.5s background-color linear;
}
.transition {
  background-color: blue;
}
</style>
```

æ¼”ç¤ºæ•ˆæœï¼š

![](./IMGS/trans_in_css.gif)

## 2. Animation in CSS

```vue
<script setup lang="ts">
// -- imports
import { ref } from 'vue';
// -- refs
const ani = ref(false);
</script>
<template>
  <div class="box" :class="{ ani }"></div>
  <button type="button" @click="ani = !ani">å¯ç”¨åŠ¨ç”»</button>
</template>

<style scoped>
@keyframes ani {
  to {
    transform: translateX(300px);
    background-color: blue;
  }
}
.box {
  width: 100px;
  height: 100px;
  margin-bottom: 16px;
  background-color: red;
}
.ani {
  animation: ani 2s linear 1 forwards;
}
</style>
```

æ¼”ç¤ºæ•ˆæœï¼š

![](./IMGS/ani_in_css.gif)

# ä¸‰ã€è¿‡æ¸¡ & åŠ¨ç”»

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·äº†è§£åœ¨ Vue ä¸­ï¼Œå¦‚ä½•ä½¿ç”¨è¿‡æ¸¡ä¸åŠ¨ç”»ã€‚

## 1. åŸºæœ¬ä½¿ç”¨

å†…ç½®ç»„ä»¶ `<transition />` åœ¨ä¸‹é¢æƒ…å†µä¸­ï¼Œå¯ä»¥ç»™ä»»ä½•å…ƒç´ å’Œç»„ä»¶æ·»åŠ è¿›å…¥å’Œç¦»å¼€åŠ¨ç”»ã€‚

- ç”± `v-if` æ‰€è§¦å‘çš„åˆ‡æ¢
- ç”± `v-show` æ‰€è§¦å‘çš„åˆ‡æ¢
- ç”±ç‰¹æ®Šå…ƒç´  `<component>` åˆ‡æ¢çš„åŠ¨æ€ç»„ä»¶
- æ”¹å˜ç‰¹æ®Šçš„ `key` å±æ€§

> æç¤ºï¼š`<Transition>` ä»…æ”¯æŒå•ä¸ªå…ƒç´ æˆ–ç»„ä»¶ä½œä¸ºå…¶æ’æ§½å†…å®¹ã€‚å¦‚æœå†…å®¹æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶å¿…é¡»ä»…æœ‰ä¸€ä¸ªæ ¹å…ƒç´ ã€‚

å½“ä¸€ä¸ª `<Transition>` ç»„ä»¶ä¸­çš„å…ƒç´ è¢«æ’å…¥æˆ–ç§»é™¤æ—¶ï¼Œä¼šå‘ç”Ÿä¸‹é¢è¿™äº›äº‹æƒ…ï¼š

1. Vue ä¼šè‡ªåŠ¨æ£€æµ‹ç›®æ ‡å…ƒç´ æ˜¯å¦åº”ç”¨äº† CSS è¿‡æ¸¡æˆ–åŠ¨ç”»ã€‚å¦‚æœæ˜¯ï¼Œåˆ™ä¸€äº› [CSS è¿‡æ¸¡ class](https://cn.vuejs.org/guide/built-ins/transition.html#transition-classes) ä¼šåœ¨é€‚å½“çš„æ—¶æœºè¢«æ·»åŠ å’Œç§»é™¤ã€‚
2. å¦‚æœæœ‰ä½œä¸ºç›‘å¬å™¨çš„ [JavaScript é’©å­](https://cn.vuejs.org/guide/built-ins/transition.html#javascript-hooks)ï¼Œè¿™äº›é’©å­å‡½æ•°ä¼šåœ¨é€‚å½“æ—¶æœºè¢«è°ƒç”¨ã€‚
3. å¦‚æœæ²¡æœ‰æ¢æµ‹åˆ° CSS è¿‡æ¸¡æˆ–åŠ¨ç”»ã€ä¹Ÿæ²¡æœ‰æä¾› JavaScript é’©å­ï¼Œé‚£ä¹ˆ DOM çš„æ’å…¥ã€åˆ é™¤æ“ä½œå°†åœ¨æµè§ˆå™¨çš„ä¸‹ä¸€ä¸ªåŠ¨ç”»å¸§åæ‰§è¡Œã€‚

## 2. è¿‡æ¸¡ç±»å

åœ¨è¿›å…¥/ç¦»å¼€çš„è¿‡æ¸¡ä¸­ï¼Œä¼šæœ‰ 6 ä¸ª class åˆ‡æ¢ã€‚

![](./IMGS/transition-classes.f0f7b3c9.png)

1. `v-enter-from`ï¼šè¿›å…¥åŠ¨ç”»çš„èµ·å§‹çŠ¶æ€ã€‚åœ¨å…ƒç´ æ’å…¥ä¹‹å‰æ·»åŠ ï¼Œåœ¨å…ƒç´ æ’å…¥å®Œæˆåçš„ä¸‹ä¸€å¸§ç§»é™¤ã€‚
2. `v-enter-active`ï¼šè¿›å…¥åŠ¨ç”»çš„ç”Ÿæ•ˆçŠ¶æ€ã€‚åº”ç”¨äºæ•´ä¸ªè¿›å…¥åŠ¨ç”»é˜¶æ®µã€‚åœ¨å…ƒç´ è¢«æ’å…¥ä¹‹å‰æ·»åŠ ï¼Œåœ¨è¿‡æ¸¡æˆ–åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚è¿™ä¸ª class å¯ä»¥è¢«ç”¨æ¥å®šä¹‰è¿›å…¥åŠ¨ç”»çš„æŒç»­æ—¶é—´ã€å»¶è¿Ÿä¸é€Ÿåº¦æ›²çº¿ç±»å‹ã€‚
3. `v-enter-to`ï¼šè¿›å…¥åŠ¨ç”»çš„ç»“æŸçŠ¶æ€ã€‚åœ¨å…ƒç´ æ’å…¥å®Œæˆåçš„ä¸‹ä¸€å¸§è¢«æ·»åŠ  (ä¹Ÿå°±æ˜¯ `v-enter-from` è¢«ç§»é™¤çš„åŒæ—¶)ï¼Œåœ¨è¿‡æ¸¡æˆ–åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚
4. `v-leave-from`ï¼šç¦»å¼€åŠ¨ç”»çš„èµ·å§‹çŠ¶æ€ã€‚åœ¨ç¦»å¼€è¿‡æ¸¡æ•ˆæœè¢«è§¦å‘æ—¶ç«‹å³æ·»åŠ ï¼Œåœ¨ä¸€å¸§åè¢«ç§»é™¤ã€‚
5. `v-leave-active`ï¼šç¦»å¼€åŠ¨ç”»çš„ç”Ÿæ•ˆçŠ¶æ€ã€‚åº”ç”¨äºæ•´ä¸ªç¦»å¼€åŠ¨ç”»é˜¶æ®µã€‚åœ¨ç¦»å¼€è¿‡æ¸¡æ•ˆæœè¢«è§¦å‘æ—¶ç«‹å³æ·»åŠ ï¼Œåœ¨è¿‡æ¸¡æˆ–åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚è¿™ä¸ª class å¯ä»¥è¢«ç”¨æ¥å®šä¹‰ç¦»å¼€åŠ¨ç”»çš„æŒç»­æ—¶é—´ã€å»¶è¿Ÿä¸é€Ÿåº¦æ›²çº¿ç±»å‹ã€‚
6. `v-leave-to`ï¼šç¦»å¼€åŠ¨ç”»çš„ç»“æŸçŠ¶æ€ã€‚åœ¨ä¸€ä¸ªç¦»å¼€åŠ¨ç”»è¢«è§¦å‘åçš„ä¸‹ä¸€å¸§è¢«æ·»åŠ  (ä¹Ÿå°±æ˜¯ `v-leave-from` è¢«ç§»é™¤çš„åŒæ—¶)ï¼Œåœ¨è¿‡æ¸¡æˆ–åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚

æ³¨æ„ï¼šå‡è®¾ `transition` è®¾æœ‰ `name`  å±æ€§ï¼Œclass åå°† `v-` æ›¿æ¢ä¸º `name å±æ€§å€¼-`ã€‚

æ¯”å¦‚ï¼š`<transition name="fade >"`ï¼Œé‚£ä¹ˆ `v-enter-from` å°†è¢«æ›¿æ¢ä¸º `fade-enter-from`ï¼Œä»¥æ­¤ç±»æ¨ã€‚

## 3. å•å…ƒç´ /ç»„ä»¶è¿‡æ¸¡

### 3.1. CSS è¿‡æ¸¡

CSS è¿‡æ¸¡æ˜¯æœ€å¸¸ç”¨çš„è¿‡æ¸¡ç±»å‹ä¹‹ä¸€ï¼Œä¸¾ä¾‹ï¼š

```vue
<script setup lang="ts">
import { ref } from 'vue';
const visible = ref(true);
</script>

<template>
  <button type="button" @click="visible = !visible">Toggle</button>
  <transition name="slide-fade">
    <div v-show="visible" class="box"></div>
  </transition>
</template>

<style scoped>
.box {
  width: 100px;
  height: 100px;
  margin-top: 16px;
  background-color: red;
}
/* å¯ä»¥ä¸ºè¿›å…¥å’Œç¦»å¼€åŠ¨ç”»è®¾ç½®ä¸åŒçš„æŒç»­æ—¶é—´å’ŒåŠ¨ç”»å‡½æ•° */
.slide-fade-enter-active {
  transition: all 0.75s ease-out;
}

.slide-fade-leave-active {
  transition: all 1s cubic-bezier(1, 0.5, 0.8, 1);
}

.slide-fade-enter-from,
.slide-fade-leave-to {
  transform: translateX(300px);
  opacity: 0;
}
</style>
```

æ•ˆæœæ¼”ç¤ºï¼š

![](IMGS/transition-01.gif)

ä¸Šè¿°ç¤ºä¾‹ï¼Œç‚¹å‡» `Toggle` æŒ‰é’®ï¼Œåˆ‡æ¢å…ƒç´ æ˜¾ç¤ºçŠ¶æ€ï¼Œä½¿å¾—å…ƒç´ å‘å³ä½ç§» 300 åƒç´ ï¼Œé€æ˜é€æ¸ä¸º0éšè—å…ƒç´ ï¼Œå‘ˆç°å…ƒç´ æ•ˆæœç›¸åã€‚

### 3.2. CSS åŠ¨ç”»

CSS åŠ¨ç”»ç”¨æ³•åŒ CSS è¿‡æ¸¡ï¼ŒåŒºåˆ«æ˜¯åœ¨åŠ¨ç”»ä¸­ `v-enter-from` ç±»åœ¨èŠ‚ç‚¹æ’å…¥ DOM åä¸ä¼šç«‹å³ç§»é™¤ï¼Œè€Œæ˜¯åœ¨ `animationend` äº‹ä»¶è§¦å‘æ—¶ç§»é™¤ã€‚

```vue
<script setup lang="ts">
import { ref } from 'vue';
const visible = ref(true);
</script>

<template>
  <button type="button" @click="visible = !visible">Toggle</button>
  <transition name="bounce">
    <div v-show="visible" class="box"></div>
  </transition>
</template>

<style scoped>
.box {
  width: 100px;
  height: 100px;
  margin-top: 16px;
  background-color: red;
}
.bounce-enter-active {
  animation: bounce-in 0.5s;
}
.bounce-leave-active {
  animation: bounce-in 0.5s reverse;
}
@keyframes bounce-in {
  0% {
    transform: scale(0);
  }
  50% {
    transform: scale(1.25);
  }
  100% {
    transform: scale(1);
  }
}
</style>

```

> ä»£ç è§£è¯»ï¼š
>
> 1ï¼‰ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œé€šè¿‡ `@keyframes` å®šä¹‰ `bounce-in` åŠ¨ç”»ï¼Œè¯¥åŠ¨ç”»ä»0å¼€å§‹ç¼©æ”¾åˆ°1.25å€å†è°ƒæ•´åˆ°1å€ï¼Œæ‰€ä»¥æœ‰ä¼šä¸€ç§ä»æ— åˆ°æœ‰ï¼Œå…ˆæ”¾å¤§å†ç¼©å›åŸå§‹å°ºå¯¸çš„æ•ˆæœã€‚
>
> 2ï¼‰éšè—å…ƒç´ æ—¶åŒæ ·ä½¿ç”¨ `bounce-in` åŠ¨ç”»ï¼Œä¸è¿‡å¢åŠ äº† `reverse` å…³é”®å­—ï¼Œè¯¥å…³é”®å­—çš„ä½œç”¨å’Œæ˜¾ç¤ºçš„åŠ¨ç”»åˆšå¥½ç›¸åï¼Œè®©é¢„å®šä¹‰åŠ¨ç”»åå‘æ‰§è¡Œã€‚

æ•ˆæœæ¼”ç¤ºï¼š

![](IMGS/animation-01.gif)

### 3.3. è‡ªå®šä¹‰ç±»å & animate.css

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å±æ€§æ¥è‡ªå®šä¹‰è¿‡æ¸¡ç±»åï¼š

- `enter-from-class`
- `enter-active-class`
- `enter-to-class`
- `leave-from-class`
- `leave-active-class`
- `leave-to-class`

å®ƒä»¬çš„ä¼˜å…ˆçº§é«˜äºæ™®é€šçš„ç±»åï¼Œå½“ä½ å¸Œæœ›å°†å…¶å®ƒç¬¬ä¸‰æ–¹ CSS åŠ¨ç”»åº“ä¸ Vue çš„è¿‡åº¦ç³»ç»Ÿç›¸ç»“åˆæ—¶ååˆ†æœ‰ç”¨ï¼Œæ¯”å¦‚ [Animate.css](https://daneden.github.io/animate.css/)ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬å°è¯•ä½¿ç”¨ Animate.cssï¼š

**Steps 1ï¼šå®‰è£… animate.css**

```shell
$ npm install animate.css
```

**Steps 2ï¼šå¯¼å…¥**

```js
import 'animate.css'
```

**Steps 3ï¼šæ‰“å¼€ [Animate.css >>](https://animate.style/) å®˜ç½‘ï¼Œé€‰æ‹©æ•ˆæœå¹¶å¤åˆ¶æ•ˆæœç±»åï¼ˆclass name)**

![](./IMGS/animate_css_guide.png)

åº”ç”¨ç¤ºä¾‹ï¼š

```html
<h1 class="animate__animated animate__bounce">An animated element</h1>
```

> æç¤ºï¼š`animate__animated` è¿™ä¸ª className **ä¸€å®šè¦** åŠ ä¸Šï¼Œ**ä¸èƒ½çœç•¥**ã€‚

**Steps 4ï¼š ç¼–å†™ä»£ç ï¼Œç²˜è´´æ•ˆæœç±»åï¼ˆclass name)**


```html
<script setup lang="ts">
import { ref } from 'vue';
const visible = ref(true);
</script>

<template>
  <button type="button" @click="visible = !visible">Toggle</button>
  <transition
    enter-active-class="animate__animated animate__bounceIn"
    leave-active-class="animate__animated animate__slideOutRight"
  >
    <h1 v-show="visible">Animate.css</h1>
  </transition>
</template>
```

æ•ˆæœæ¼”ç¤ºï¼š

![](IMGS/animation-css.gif)

### 3.4. åŒæ—¶ä½¿ç”¨è¿‡æ¸¡å’ŒåŠ¨ç”»

Vue ä¸ºäº†çŸ¥é“è¿‡æ¸¡ä½•æ—¶å®Œæˆï¼Œå¿…é¡»è®¾ç½®ç›¸åº”çš„äº‹ä»¶ç›‘å¬å™¨ã€‚å®ƒå¯ä»¥æ˜¯ `@transitionend` æˆ– `@animationend`ï¼Œè¿™å–å†³äºç»™å…ƒç´ åº”ç”¨çš„ CSS è§„åˆ™ã€‚å¦‚æœä½ åªä½¿ç”¨äº†å…¶ä¸­ä¸€ç§ï¼ŒVue èƒ½è‡ªåŠ¨è¯†åˆ«å…¶æ­£ç¡®ç±»å‹ã€‚

ä½†æ˜¯ï¼Œåœ¨ä¸€äº›åœºæ™¯ä¸­ï¼Œä½ éœ€è¦ç»™åŒä¸€ä¸ªå…ƒç´ åŒæ—¶è®¾ç½®ä¸¤ç§è¿‡æ¸¡åŠ¨æ•ˆï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªé€šè¿‡ Vue è§¦å‘çš„ CSS åŠ¨ç”»ï¼Œå¹¶ä¸”åœ¨æ‚¬åœæ—¶ç»“åˆä¸€ä¸ª CSS è¿‡æ¸¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸­ï¼Œä½ å°±éœ€è¦ä½¿ç”¨ `type` å±æ€§å¹¶è®¾ç½® `animation` æˆ– `transition` æ¥æ˜¾å¼å£°æ˜ä½ éœ€è¦ Vue ç›‘å¬çš„ç±»å‹ã€‚

### 3.5. æ˜¾æ€§çš„è¿‡æ¸¡æŒç»­æ—¶é—´

Vue åœ¨ `<transition>` ç»„ä»¶ä¸Šæä¾› `duration` å±æ€§æ˜¾å¼æŒ‡å®šè¿‡æ¸¡æŒç»­æ—¶é—´ (ä»¥æ¯«ç§’è®¡)ï¼š

```vue
<transition :duration="1000">...</transition>
```

ä½ ä¹Ÿå¯ä»¥åˆ†åˆ«æŒ‡å®šè¿›å…¥å’Œç¦»å¼€çš„æŒç»­æ—¶é—´ï¼š

```vue
<transition :duration="{ enter: 500, leave: 800 }">...</transition>
```

### 3.6. JavaScript é’©å­å‡½æ•°

å¯ä»¥åœ¨ å±æ€§ ä¸­å£°æ˜ JavaScript é’©å­ï¼š

```vue
<transition
  @before-enter="beforeEnter"
  @enter="enter"
  @after-enter="afterEnter"
  @enter-cancelled="enterCancelled"
  @before-leave="beforeLeave"
  @leave="leave"
  @after-leave="afterLeave"
  @leave-cancelled="leaveCancelled"
  :css="false"
>
  <!-- ... -->
</transition>
```

- å’Œä¹‹å‰åœ¨ CSS ä¸­çš„ç±»åç±»ä¼¼ï¼Œè¿™äº›é’©å­å‡½æ•°ä¼šåœ¨è¿‡æ¸¡åˆ°äº†å¯¹åº”é˜¶æ®µè°ƒç”¨ï¼›
- `cancelled` æ˜¯åœ¨è¿‡ç¨‹ä¸­æ’¤é”€æ“ä½œï¼Œæ‰ä¼šå›è°ƒ;
- `enter` å’Œ `leave` å¯¹åº”çš„é’©å­å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼š
  - `el`ï¼šå‚ä¸åŠ¨ç”»çš„å…ƒç´ ï¼›
  - `done`ï¼šè¿‡æ¸¡è¿‡ç¨‹æ˜¯å¦å®Œæˆï¼›
- `css:false`ï¼šä½¿å…ƒç´ è®¾ç½®çš„åŠ¨ç”» CSS å¤±æ•ˆï¼›

## 4. åˆå§‹æ¸²æŸ“çš„è¿‡æ¸¡

å¯ä»¥é€šè¿‡ `appear` å±æ€§è®¾ç½®èŠ‚ç‚¹åœ¨ **åˆå§‹æ¸²æŸ“**ï¼ˆå³é¡µé¢åœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±æ‰§è¡Œä¸€æ¬¡åŠ¨ç”»ï¼‰ çš„è¿‡æ¸¡ï¼š

```vue
<transition appear>
  <!-- ... -->
</transition>
```

## 5ã€å¤šå…ƒç´ è¿‡æ¸¡

å¯¹äºåŸç”Ÿæ ‡ç­¾å¯ä»¥ä½¿ç”¨ `v-if`/`v-else` ã€‚æœ€å¸¸è§çš„å¤šæ ‡ç­¾è¿‡æ¸¡æ˜¯ä¸€ä¸ªåˆ—è¡¨å’Œæè¿°è¿™ä¸ªåˆ—è¡¨ä¸ºç©ºæ¶ˆæ¯çš„å…ƒç´ ï¼š

```html
<transition>
  <table v-if="items.length > 0">
    <!-- ... -->
  </table>
  <p v-else>Sorry, no items found.</p>
</transition>
```

å®é™…ä¸Šï¼Œé€šè¿‡ä½¿ç”¨ `v-if`/`v-else-if`/`v-else` æˆ–å°†å•ä¸ªå…ƒç´ ç»‘å®šåˆ°ä¸€ä¸ªåŠ¨æ€å±æ€§ï¼Œå¯ä»¥åœ¨ä»»æ„æ•°é‡çš„å…ƒç´ ä¹‹é—´è¿›è¡Œè¿‡æ¸¡ã€‚ä¾‹å¦‚ï¼š

```html
<transition>
  <button v-if="docState === 'saved'" key="saved">Edit</button>
  <button v-else-if="docState === 'edited'" key="edited">Save</button>
  <button v-else-if="docState === 'editing'" key="editing">Cancel</button>
</transition>
```

å¯ä»¥é‡å†™ä¸ºï¼š

```vue
<script setup lang="ts">
import { ref, computed } from 'vue';

const docState = ref('saved');

const buttonMessage = computed(() => {
  switch (docState.value) {
    case 'saved':return 'Edit';
    case 'edited':return 'Save';
    case 'editing': return 'Cancel';
  }
});
</script>

<template>
  <transition>
    <button :key="docState">{{buttonMessage}}</button>
  </transition>
</template>
```

### @è¿‡æ¸¡æ¨¡å¼

`<transition>` çš„é»˜è®¤è¡Œä¸º - è¿›å…¥å’Œç¦»å¼€åŒæ—¶å‘ç”Ÿï¼Œå³ **ä¸Šä¸€ä¸ªç»„ä»¶è¿˜åœ¨æ¶ˆå¤±çš„è¿‡ç¨‹ä¸­ï¼Œä½†ä¸‹ä¸€ä¸ªç»„ä»¶å·²ç»åœ¨å‡ºç°è¿‡ç¨‹ä¸­**ã€‚æˆ‘ä»¬çœ‹çœ‹ä¸€ç»„ç¤ºä¾‹ï¼š

```vue
<script setup lang="ts">
import { ref, computed } from 'vue';

// -- å®šä¹‰ buttonState å½¢çŠ¶ï¼ˆTSè¯­æ³•ï¼‰
type ButtonStateType = 'disable' | 'enable';
// -- å®šä¹‰ buttonState å˜é‡ï¼Œå…¶ç±»å‹ä¸º ButtonStateType
const buttonState = ref<ButtonStateType>('disable');
</script>

<template>
  <transition>
    <button type="button" v-if="buttonState === 'enable'" @click="buttonState = 'disable'">ç¦ç”¨</button>
    <button type="button" v-else @click="buttonState = 'enable'">å¯ç”¨</button>
  </transition>
</template>

<style scoped>

@keyframes move-in {
  from {
    transform: translateX(100px);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

button {
  /* ä¸ºäº†æ–¹ä¾¿æŸ¥çœ‹æ•ˆæœï¼Œä½¿ç”¨ç»å¯¹å®šä½ä½¿å…¶é‡å åœ¨ä¸€èµ· */
  position: absolute;
}
.v-enter-active {
  animation: move-in 1s linear;
}
.v-leave-active {
  animation: move-in 1s linear reverse;
}
</style>
```

ç¤ºä¾‹æ•ˆæœï¼š

![](./IMGS/trans_mode.gif)

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å¤šç»„ä»¶åˆ‡æ¢æ—¶ï¼Œè¿›å…¥å’Œç¦»å¼€æ˜¯åŒæ—¶å‘ç”Ÿçš„ã€‚åŒæ—¶ç”Ÿæ•ˆçš„è¿›å…¥å’Œç¦»å¼€çš„è¿‡æ¸¡ä¸èƒ½æ»¡è¶³æ‰€æœ‰è¦æ±‚ï¼Œæ‰€ä»¥ Vue æä¾›äº† **è¿‡æ¸¡æ¨¡å¼**

- `in-out`ï¼šæ–°å…ƒç´ å…ˆè¿›è¡Œè¿›å…¥è¿‡æ¸¡ï¼Œå®Œæˆä¹‹åå½“å‰å…ƒç´ è¿‡æ¸¡ç¦»å¼€ã€‚

- `out-in`ï¼šå½“å‰å…ƒç´ å…ˆè¿›è¡Œç¦»å¼€è¿‡æ¸¡ï¼Œå®Œæˆä¹‹åæ–°å…ƒç´ è¿‡æ¸¡è¿›å…¥ã€‚

è¯­æ³•å½¢å¼å¦‚ä¸‹ï¼š

```vue
<transition mode="in-out">
  <!-- ... the buttons ... -->
</transition>
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ‡æ¢ä¸¤ç§æ¨¡å¼æŸ¥çœ‹æ•ˆæœï¼š

> **`in-out`**

![](./IMGS/trans_mode_in_out.gif)

> **`out-in`**

![](./IMGS/trans_mode_out_in.gif)

ä¸éš¾å‘ç°ï¼Œ`in-out` å’Œ `out-in` æ¨¡å¼åˆšå¥½ç›¸åã€‚

# å››ã€åˆ—è¡¨è¿‡æ¸¡

ç›®å‰ä¸ºæ­¢ï¼Œå…³äºè¿‡æ¸¡æˆ‘ä»¬å·²ç»è®²åˆ°ï¼š

- å•ä¸ªèŠ‚ç‚¹
- å¤šä¸ªèŠ‚ç‚¹ï¼Œæ¯æ¬¡åªæ¸²æŸ“ä¸€ä¸ª

é‚£ä¹ˆæ€ä¹ˆåŒæ—¶æ¸²æŸ“æ•´ä¸ªåˆ—è¡¨ï¼Œæ¯”å¦‚ä½¿ç”¨ `v-for`ï¼Ÿåœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ `<transition-group>` ç»„ä»¶ã€‚åœ¨æˆ‘ä»¬æ·±å…¥ä¾‹å­ä¹‹å‰ï¼Œå…ˆäº†è§£å…³äºè¿™ä¸ªç»„ä»¶çš„å‡ ä¸ªç‰¹ç‚¹ï¼š

- é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¸ä¼šæ¸²æŸ“ä¸€ä¸ªåŒ…è£¹å…ƒç´ ï¼Œä½†æ˜¯ä½ å¯ä»¥é€šè¿‡ `tag` å±æ€§ æŒ‡å®šæ¸²æŸ“ä¸€ä¸ªå…ƒç´ ã€‚
- è¿‡æ¸¡æ¨¡å¼ä¸å¯ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å†ç›¸äº’åˆ‡æ¢ç‰¹æœ‰çš„å…ƒç´ ã€‚
- å†…éƒ¨å…ƒç´  **æ€»æ˜¯éœ€è¦** æä¾›å”¯ä¸€çš„ `key` å±æ€§å€¼ã€‚
- CSS è¿‡æ¸¡çš„ç±»å°†ä¼šåº”ç”¨åœ¨å†…éƒ¨çš„å…ƒç´ ä¸­ï¼Œè€Œä¸æ˜¯è¿™ä¸ªç»„/å®¹å™¨æœ¬èº«ã€‚

## 1. åˆ—è¡¨çš„è¿›å…¥& ç¦»å¼€è¿‡æ¸¡

ç°åœ¨è®©æˆ‘ä»¬ç”±ä¸€ä¸ªç®€å•çš„ä¾‹å­æ·±å…¥ï¼Œè¿›å…¥å’Œç¦»å¼€çš„è¿‡æ¸¡ä½¿ç”¨ä¹‹å‰ä¸€æ ·çš„ CSS ç±»åã€‚

```vue
<script setup lang="ts">
import { reactive } from 'vue';

const state = reactive({
  list: [1, 2, 3, 4, 5, 6],
  nextNum: 7,
});

// methods
const randomIndex = () => Math.floor(Math.random() * state.list.length);
// events
const onInsert = () => {
  state.list.splice(randomIndex(), 0, ++state.nextNum);
};
const onRemove = () => {
  state.list.splice(randomIndex(), 1);
};
</script>

<template>
  <!-- æŒ‰é’® -->
  <button type="button" @click="onInsert">INSERT</button>
  <button type="button" @click="onRemove">REMOVE</button>
  <!-- åˆ—è¡¨æ¸²æŸ“ -->
  <transition-group name="list" tag="div" class="list">
    <div class="item" v-for="item in state.list" :key="item">
      {{ item }}
    </div>
  </transition-group>
</template>

<style scoped>
button {
  margin-right: 10px;
  margin-bottom: 16px;
  cursor: pointer;
}
.item {
  display: inline-block;
  margin-right: 10px;
}

.list-enter-active,
.list-leave-active {
  transition: all 1s ease;
}
.list-enter-from,
.list-leave-to {
  opacity: 0;
  transform: translateY(30px);
}
</style>
```

ç¤ºä¾‹æ•ˆæœï¼š

![](IMGS/trans_list_1.gif)

è¿™ä¸ªä¾‹å­æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå½“æ·»åŠ å’Œç§»é™¤å…ƒç´ çš„æ—¶å€™ï¼Œå‘¨å›´çš„å…ƒç´ ä¼š **ç¬é—´ç§»åŠ¨** åˆ°å®ƒä»¬çš„æ–°å¸ƒå±€çš„ä½ç½®ï¼Œè€Œä¸æ˜¯å¹³æ»‘çš„è¿‡æ¸¡ï¼Œæˆ‘ä»¬ä¸‹é¢ä¼šè§£å†³è¿™ä¸ªé—®é¢˜ã€‚

## 2. åˆ—è¡¨çš„ç§»åŠ¨è¿‡æ¸¡

ä¸ºäº†è§£å†³ä¸Šè¿°ç¤ºä¾‹åœ¨æ·»åŠ å…ƒç´ æ—¶ç¬é—´ç§»åŠ¨çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨æ–°å¢çš„ **`v-move`** ç±»ï¼Œå®ƒä¼šåº”ç”¨åœ¨å…ƒç´ æ”¹å˜å®šä½çš„è¿‡ç¨‹ä¸­ã€‚åƒä¹‹å‰çš„ç±»åä¸€æ ·ï¼Œå®ƒçš„å‰ç¼€å¯ä»¥é€šè¿‡ `name` å±æ€§æ¥è‡ªå®šä¹‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ `move-class` å±æ€§æ‰‹åŠ¨è®¾ç½®ã€‚

`v-move` å¯¹äºè®¾ç½®è¿‡æ¸¡çš„åˆ‡æ¢æ—¶æœºå’Œè¿‡æ¸¡æ›²çº¿éå¸¸æœ‰ç”¨ï¼Œç»§ç»­ä¸Šè¿°çš„ä¾‹å­ï¼Œæˆ‘ä»¬é€šè¿‡ [Lodash >>](https://www.lodashjs.com/)  æ‰“ä¹±é›†åˆé¡ºåºã€‚

é¦–å…ˆå®‰è£… loadashï¼š

```shell
$ npm install lodash
$ npm install @types/lodash --save-dev
```

ä¿®æ”¹ç¤ºä¾‹ä»£ç ï¼š

```vue
<script setup lang="ts">
// +++
import _ from 'lodash';
// +++

import { reactive } from 'vue';

const state = reactive({
  list: [1, 2, 3, 4, 5, 6],
  nextNum: 7
});

// methods
const randomIndex = () => Math.floor(Math.random() * state.list.length);
// events
// +++
const onShuffle = () => {
  // æ‰“ä¹±é›†åˆé¡ºåº
  state.list = _.shuffle(state.list);
};
// +++
const onInsert = () => {
  state.list.splice(randomIndex(), 0, ++state.nextNum);
};
const onRemove = () => {
  state.list.splice(randomIndex(), 1);
};
</script>

<template>
  <!-- +++ -->
  <button type="button" @click="onShuffle">SHUFFLE</button>
  <!-- +++ -->
  <button type="button" @click="onInsert">INSERT</button>
  <button type="button" @click="onRemove">REMOVE</button>
  <transition-group name="list" tag="div" class="list">
    <div class="item" v-for="item in state.list" :key="item">
      {{ item }}
    </div>
  </transition-group>
</template>

<style scoped>
button {
  margin-right: 10px;
  margin-bottom: 16px;
  cursor: pointer;
}
.item {
  display: inline-block;
  margin-right: 10px;
}

/* +++ */
.list-move {
  transition: transform 1s;
}
/* +++ */

.list-enter-active,
.list-leave-active {
  transition: all 1s ease;
}
.list-enter-from,
.list-leave-to {
  opacity: 0;
  transform: translateY(30px);
}
</style>
```

> æç¤ºï¼šä»£ç ä¸­çš„ `+++` è¡¨ç¤ºæ–°å¢ä»£ç ã€‚

æ¼”ç¤ºæ•ˆæœï¼š

![](IMGS/list-move.gif)

è¿™ä¸ªçœ‹èµ·æ¥å¾ˆç¥å¥‡ï¼Œå…¶å® Vue å†…éƒ¨ä½¿ç”¨äº†ä¸€ä¸ªå« [FLIP](https://aerotwist.com/blog/flip-your-animations/) çš„åŠ¨ç”»æŠ€æœ¯ï¼Œå®ƒä½¿ç”¨ transform å°†å…ƒç´ ä»ä¹‹å‰çš„ä½ç½®å¹³æ»‘è¿‡æ¸¡åˆ°æ–°çš„ä½ç½®ã€‚

> æç¤ºï¼šéœ€è¦æ³¨æ„çš„æ˜¯ä½¿ç”¨ FLIP è¿‡æ¸¡çš„å…ƒç´ ä¸èƒ½è®¾ç½®ä¸º `display: inline`ã€‚ä½œä¸ºæ›¿ä»£æ–¹æ¡ˆï¼Œå¯ä»¥è®¾ç½®ä¸º `display: inline-block` æˆ–è€…å°†å…ƒç´ æ”¾ç½®äº flex å¸ƒå±€ä¸­ã€‚

## 3. åˆ—è¡¨çš„äº¤é”™è¿‡æ¸¡

é€šè¿‡ data å±æ€§ä¸ JavaScript é€šä¿¡ï¼Œå°±å¯ä»¥å®ç°åˆ—è¡¨çš„äº¤é”™è¿‡æ¸¡ï¼š

```vue
<script setup lang="ts">
import { reactive } from 'vue';
import gsap from 'gsap';

interface StateProps {
  list: number[] | null;
}
const state = reactive<StateProps>({
  list: null,
});

// -- æ¨¡æ‹Ÿè¯·æ±‚æ•°æ®
setTimeout(() => {
  state.list = [1, 2, 3, 4, 5];
}, 1000);

const beforeEnter = (el: Element) => {
  const dom = el as HTMLDivElement;
  dom.style.cssText = 'opacity: 0; transform: translateY(30px)';
};
const enter = (el: Element, done: () => void) => {
  const dom = el as HTMLDivElement;
  const dataset = dom.dataset;
  const index = dataset.index || ''; /** è·å–data-indexï¼Œç”¨äºè®¾ç½®å»¶è¿Ÿä»¥è¾¾åˆ°åˆ—è¡¨äº¤é”™æ•ˆæœ */
  gsap.to(dom, {
    duration: 1,
    opacity: 1,
    translateY: 0,
    delay: +index * 0.25,
    onComplete: done,
  });
};
</script>

<template>
  <transition-group
    tag="div"
    :css="false"
    @before-enter="beforeEnter"
    @enter="enter"
  >
    <div
      class="item"
      v-for="(item, index) in state.list"
      :key="item"
      :data-index="index"
    >
      <div class="avatar"></div>
      <div class="info">
        <div class="title"></div>
        <div class="desc"></div>
      </div>
    </div>
  </transition-group>
</template>

<style scoped>
.item {
  width: 90%;
  padding: 10px;
  border-radius: 6px;
  box-shadow: 0 0 10px 1px #eeeeee;
  margin: 0 auto 16px;
  display: flex;
  align-items: center;
}
.avatar {
  width: 60px;
  height: 60px;
  background: #6bb6fc;
  border-radius: 12px;
  margin-right: 16px;
}
.title {
  width: 160px;
  height: 20px;
  border-radius: 20px;
  background: #6bb6fc;
  margin-bottom: 10px;
}
.desc {
  width: 80px;
  height: 20px;
  border-radius: 20px;
  background: #9ed0f8;
}
</style>
```

æ¼”ç¤ºæ•ˆæœï¼š

![](./IMGS/list-stagger.gif)



# äº”ã€çŠ¶æ€è¿‡æ¸¡

Vue çš„è¿‡æ¸¡ç³»ç»Ÿæä¾›äº†éå¸¸å¤šç®€å•çš„æ–¹æ³•æ¥è®¾ç½®è¿›å…¥ã€ç¦»å¼€å’Œåˆ—è¡¨çš„åŠ¨æ•ˆï¼Œé‚£ä¹ˆå¯¹äºæ•°æ®å…ƒç´ æœ¬èº«çš„åŠ¨æ•ˆå‘¢ï¼Ÿæ¯”å¦‚ï¼š

- æ•°å­—å’Œè¿ç®—
- é¢œè‰²çš„æ˜¾ç¤º
- SVG èŠ‚ç‚¹çš„ä½ç½®
- å…ƒç´ çš„å¤§å°å’Œå…¶ä»–çš„å±æ€§

è¿™äº›æ•°æ®è¦ä¹ˆæœ¬èº«å°±ä»¥æ•°å€¼å½¢å¼å­˜å‚¨ï¼Œè¦ä¹ˆå¯ä»¥è½¬æ¢ä¸ºæ•°å€¼ã€‚æœ‰äº†è¿™äº›æ•°å€¼åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»“åˆ Vue çš„å“åº”æ€§å’Œç»„ä»¶ç³»ç»Ÿï¼Œä½¿ç”¨ **ç¬¬ä¸‰æ–¹åº“** æ¥å®ç°åˆ‡æ¢å…ƒç´ çš„è¿‡æ¸¡çŠ¶æ€ã€‚

## @GSAP

GSAPæ˜¯ GreenSock æä¾›çš„ä¸€ä¸ªåˆ¶ä½œåŠ¨ç”»çš„ JavaScript åº“ï¼š

- [è‹±æ–‡å®˜ç½‘ >>](https://greensock.com/)

- [ä¸­æ–‡ç½‘åœ°å€ >>](https://www.tweenmax.com.cn/index.html)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡ GSAP ç»“åˆ Vue å®ç°æ•°å­—æ»šåŠ¨çš„æ•ˆæœã€‚

é¦–å…ˆï¼Œå®‰è£… gsapï¼š

```shell
$ npm install gsap
```

ç„¶åç›´æ¥ä¸Šç¤ºä¾‹ä»£ç ï¼š

```vue
<script setup lang="ts">
import { reactive } from 'vue';
import gsap from 'gsap';

const state = reactive({
  count: 100,
});

const onPlus = () => {
  gsap.to(state, {
    duration: 0.75 /** æŒç»­æ—¶é—´ */,
    count: state.count + Math.random() * 100 /** å˜æ›´key-value */,
    ease: 'sine' /** é€Ÿåº¦æ›²çº¿ */,
  });
};
</script>

<template>
  <button type="button" style="cursor: pointer" @click="onPlus">å¢åŠ æ•°é¢</button>
  <p>&yen;&nbsp;{{ state.count.toFixed(2) }}</p>
</template>
```

æ¼”ç¤ºæ•ˆæœï¼š

![](IMGS/trans_gsap.gif)

# å…­ã€Examples

## ğŸ‘‰ ä½ç§»åŠ¨ç”»@v-move-active

åˆ—è¡¨çš„è¿›å…¥ & ç¦»å¼€è¿‡æ¸¡ï¼Œå¯¹åˆ—è¡¨ç›´æ¥æ“ä½œï¼ˆå¢ã€åˆ ï¼‰çš„å…ƒç´ ï¼Œå°è£… **\<transition-group>** å¹¶æŒ‰å¸¸è§„çš„ CSS æˆ– JS è¿‡æ¸¡å³å¯ï¼›ä½†åœ¨æ“ä½œè¿™äº›å…ƒç´ çš„ä½ç½®å˜åŒ–æ—¶ï¼Œç”±äºDOMæ–‡æ¡£æµçš„å˜åŒ–ï¼Œä¼šåŒæ—¶å¼•èµ·å…¶å®ƒï¼ˆé‚»è¿‘ï¼‰èŠ‚ç‚¹å…ƒç´ çš„ä½ç½®å˜åŒ–ï¼Œä¾‹å¦‚åœ¨åˆ—è¡¨æ’å…¥ä¸€ä¸ª\<li>ï¼Œæ’å…¥ç‚¹åŸæœ¬çš„\<li>ä¼šä¸‹ç§»ï¼Œåˆ é™¤ä¸€ä¸ª\<li>ï¼Œä¸‹é¢çš„\<li>ä¼šä¸Šç§»è¡¥å……å æ®è¿™ä¸ªä½ç½®ã€‚ 

å¯¹äºè¿™äº› â€œè¢«åŠ¨â€ ç§»åŠ¨çš„å…ƒç´ æ¥è¯´ï¼Œä¹Ÿå¯ä»¥å®ç°è¿‡æ¸¡ï¼Œè¿™å°±ç”¨åˆ°äº† `v-move` ç‰¹æ€§ï¼Œå…¶ä¸­ `v` å’Œè¿‡æ¸¡å±æ€§ç±»ä¼¼ï¼Œä¾èµ–äº `name` å±æ€§çš„è®¾å®šï¼Œå‡è®¾è®¾ç½® **\<transition-group name="list">**ï¼Œåˆ™è®¾ç½®è¿‡æ¸¡å±æ€§çš„ç±»åä¸ºï¼š`.list-move`ã€‚

å®ç°æ•ˆæœï¼š

![](./IMGs/transition_v_move.gif)

å®ç°ä»£ç ï¼š

```vue

<script setup lang="ts">
import { reactive } from 'vue';

interface StateProps {
  list: Array<number>;
  next: number;
}
// -- state
const state = reactive<StateProps>({
  list: [1, 2, 3, 4],
  next: 4,
});

// -- methods
const randomIndex = () => Math.floor(Math.random() * state.list.length);

// -- events
const onInsert = () => {
  state.list.splice(randomIndex(), 0, ++state.next);
};
const onRemove = () => {
  state.list.splice(randomIndex(), 1);
};
</script>

<template>
  <div class="page">
    <transition-group class="list" tag="ul" name="list">
      <!-- key å€¼ä¸èƒ½ä½¿ç”¨ä¸‹æ ‡indexï¼Œå¦åˆ™åŠ¨ç”»æ— æ•ˆ -->
      <div v-for="item in state.list" :key="item" class="item">
        {{ item }}
      </div>
    </transition-group>
    <div class="actions">
      <button @click="onInsert">INSERT</button>
      <button @click="onRemove">REMOVE</button>
    </div>
  </div>
</template>

<style lang="less">
.page {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.list-enter-from {
  opacity: (0);
  transform: translateY(-50px);
}
.list-enter-to {
  opacity: (1);
  transform: translateY(0);
}
.list-leave-from {
  opacity: (1);
}
.list-leave-to {
  opacity: (0);
}
.list-move,
.list-enter-active,
.list-leave-active {
  transition: all 0.5s ease;
}
// -- Tipsï¼šè¦è®©åˆ é™¤çš„å…ƒç´ è„±ç¦»æ–‡æ¡£æµï¼Œåé¢çš„å…ƒç´ æ‰ä¼šè¿‡æ¸¡è¿‡æ¥
.list-leave-active {
  position: absolute;
}

.list {
  margin: 50px auto;
  white-space: nowrap;
  .item {
    display: inline-block;
    width: 120px;
    line-height: 160px;
    text-align: center;
    background: linear-gradient(to bottom, #000 10%, red);
    font-size: 36px;
    color: #ffffff;
    font-family: 'Times New Roman', Times, serif;
    &:not(:last-child) {
      margin-right: 2px;
    }
  }
}

.actions {
  button {
    cursor: pointer;
    &:not(:last-child) {
      margin-right: 10px;
    }
  }
}
</style>

```

## ğŸ‘‰ æ— é™æ»šåŠ¨

åœ¨å®é™…å¼€å‘ä¸­ï¼Œé¦–é¡µå¯èƒ½ä¼šå¾ªç¯æ’­æ”¾ä¸€äº›å‡æ•°æ®ä»¥å®ç°å®æ—¶æ’­æŠ¥çš„åŠŸèƒ½ï¼Œå¦‚å¦‚ä¸‹æ•ˆæœï¼š

![](./IMGs/transition_circle_move.gif)

å®ç°ä»£ç ï¼š

```vue
<script setup lang="ts">
import { onMounted, onBeforeUnmount, reactive, nextTick } from 'vue';


interface StateProps {
  colors: Array<{ label: string; color: string }>;
  timer: any;
}
  
// -- state
const state = reactive<StateProps>({
  colors: [
    { label: 'A', color: '#4b69ff' },
    { label: 'B', color: '#e4ae39' },
    { label: 'C', color: '#8847ff' },
    { label: 'D', color: '#d32ce6' },
    { label: 'E', color: '#eb4b4b' },
  ],
  timer: null,
});

// -- life circles
onMounted(() => {
  state.timer = setInterval(() => {
    const color = state.colors.pop();
    if (color) {
      nextTick(() => {
        state.colors.unshift(color);
      });
    }
  }, 2000);
});
onBeforeUnmount(() => {
  clearInterval(state.timer);
});

// -- methods
const getBgColor = (colorStop: string) => {
  return `linear-gradient(to bottom, #000 10%, ${colorStop} 100%)`;
};
</script>

<template>
  <div class="page">
    <transition-group class="list" tag="ul" name="list">
      <!-- key å€¼ä¸èƒ½ä½¿ç”¨ä¸‹æ ‡indexï¼Œå¦åˆ™åŠ¨ç”»æ— æ•ˆ -->
      <div
        v-for="item in state.colors"
        :key="item.label"
        class="item"
        :style="{ background: getBgColor(item.color) }"
      >
        {{ item.label }}
      </div>
    </transition-group>
  </div>
</template>

<style lang="less">
  
.list-enter-from,
.list-leave-to {
  opacity: 0;
  transform: translateY(-30px);
}
.list-enter-to,
.list-leave-from {
  opacity: 1;
  transform: translateY(0);
}
.list-move,
.list-enter-active,
.list-leave-active {
  transition: all 1.5s ease;
}
  
.list {
  width: calc(120px * 4);
  margin: 50px auto;
  white-space: nowrap;
  overflow-x: hidden;
  .item {
    display: inline-block;
    width: 120px;
    line-height: 160px;
    text-align: center;
    background-color: red;
    font-size: 36px;
    color: #ffffff;
    font-family: 'Times New Roman', Times, serif;
  }
}
</style>
```



